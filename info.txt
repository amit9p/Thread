In your macro/custom_test folder, create a file named my_custom_test.sql and add 

{% macro test_my_custom_test(model) %}

select distinct *
from {{ model }}
where SURV_ID = 'SV_2c2Qt1a0Z0AFmmh'
and rspn_id = 'R_erGDbT577dFCHKB'
and rspn_id not in (
select distinct
rspn_id
from {{ model }}
where SURV_ID = 'SV_2c2Qt1a0Z0AFmmh'
and ((IMPT_ID = 'QID5' and cho_val > =0) or IMPT_ID = 'QID5'
or (IMPT_ID = 'QID2' and cho_val >=0 ) or IMPT_ID = 'QID2'
or (IMPT_ID ='QID3' and cho_val >=0) or IMPT_D = 'QID3'
or IMPT_ID ='QID1'
or IMPT_ID='QID4))

{% endmacro %}


version: 2

models:
  - name: surv_rspn_fact
    tests:
      - dbt_project_name.test_my_custom_test

