Custom Test Creation: In your custom_tests folder inside macro, create a new SQL file named check_zero_records.sql:


-- custom_tests/check_zero_records.sql

{% macro check_zero_records() %}

select distinct *
from {{ ref('surv_rspn_fact') }}
where SURV_ID = 'SV_2c2Qt1a0Z0AFmmh'
and rspn_id = 'R_erGDbT577dFCHKB'
and rspn_id not in (
select distinct
rspn_id
from {{ ref('surv_rspn_fact') }}
where SURV_ID = 'SV_2c2Qt1a0Z0AFmmh'
and ((IMPT_ID = 'QID5' and cho_val >= 0) or IMPT_ID = 'QID5'
or (IMPT_ID = 'QID2' and cho_val >= 0 ) or IMPT_ID = 'QID2'
or (IMPT_ID ='QID3' and cho_val >= 0) or IMPT_ID = 'QID3'
or IMPT_ID ='QID1'
or IMPT_ID='QID4'))

{% endmacro %}



